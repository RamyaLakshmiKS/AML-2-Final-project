# ğŸ”„ Data Flow Visualization

## System Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERACTION                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Upload JSON File     â”‚
                    â”‚  {walls: [...]}       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Gradio Interface     â”‚
                    â”‚  (app.py)             â”‚
                    â”‚  - Validate JSON      â”‚
                    â”‚  - Error handling     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  HouseBuilder Class   â”‚
                    â”‚  (builder.py)         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚               â”‚               â”‚
                â–¼               â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Buffering â”‚   â”‚ Extrusion â”‚   â”‚   Floor   â”‚
        â”‚ (Shapely) â”‚   â”‚ (Trimesh) â”‚   â”‚ Generationâ”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Trimesh Scene        â”‚
                    â”‚  (Combined 3D Model)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  GLB Export           â”‚
                    â”‚  (Binary Format)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚               â”‚               â”‚
                â–¼               â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Display  â”‚   â”‚ Download  â”‚   â”‚   Save    â”‚
        â”‚ in UI     â”‚   â”‚ to User   â”‚   â”‚ to Disk   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Geometry Processing Pipeline

```
INPUT: 2D Wall Coordinates
    â†“
[[x1, y1], [x2, y2]]
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Create Line             â”‚
â”‚                                 â”‚
â”‚  â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—                â”‚
â”‚  p1           p2                â”‚
â”‚                                 â”‚
â”‚  LineString([p1, p2])           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Buffer (Add Thickness)  â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚             â”‚ â† 0.1 units    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                 â”‚
â”‚  Polygon (2D footprint)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Extrude (Add Height)    â”‚
â”‚                                 â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â•±             â•±â”‚            â”‚
â”‚    â•±             â•± â”‚ â†‘ 2.5m     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚            â”‚
â”‚   â”‚             â”‚  â•±            â”‚
â”‚   â”‚             â”‚ â•±             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                 â”‚
â”‚  Trimesh (3D wall mesh)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Combine All Walls       â”‚
â”‚         + Add Floor             â”‚
â”‚                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚  R1 â”‚  R2 â”‚                 â”‚
â”‚   â”‚     â”‚     â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚   â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â† Floor         â”‚
â”‚                                 â”‚
â”‚  Scene (Complete 3D Model)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
OUTPUT: GLB File (3D Model)
```

## Class Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   app.py                           â”‚
â”‚                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  create_interface()                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  File Upload Component             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Sample Generator Button           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Process Button                    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  3D Model Viewer                   â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                     â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  process_floor_plan(file)                â”‚    â”‚
â”‚  â”‚  - Validate JSON                         â”‚    â”‚
â”‚  â”‚  - Call HouseBuilder                     â”‚    â”‚
â”‚  â”‚  - Return GLB path                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  builder.py                         â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  class HouseBuilder:                          â”‚ â”‚
â”‚  â”‚                                               â”‚ â”‚
â”‚  â”‚    __init__(thickness, height, offset)        â”‚ â”‚
â”‚  â”‚                                               â”‚ â”‚
â”‚  â”‚    process_floorplan(json_data)               â”‚ â”‚
â”‚  â”‚    â”‚                                          â”‚ â”‚
â”‚  â”‚    â”œâ”€â–º _create_wall_polygon(coords)          â”‚ â”‚
â”‚  â”‚    â”‚                                          â”‚ â”‚
â”‚  â”‚    â”œâ”€â–º _extrude_wall(polygon)                â”‚ â”‚
â”‚  â”‚    â”‚                                          â”‚ â”‚
â”‚  â”‚    â”œâ”€â–º _create_floor(polygons)               â”‚ â”‚
â”‚  â”‚    â”‚                                          â”‚ â”‚
â”‚  â”‚    â””â”€â–º return Scene                          â”‚ â”‚
â”‚  â”‚                                               â”‚ â”‚
â”‚  â”‚    export_to_glb(scene, path)                â”‚ â”‚
â”‚  â”‚                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚  Dependencies:                                      â”‚
â”‚  â”œâ”€ shapely.geometry (LineString, Polygon)         â”‚
â”‚  â”œâ”€ trimesh.creation (extrude_polygon)             â”‚
â”‚  â””â”€ trimesh.Scene (combine meshes)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Dependencies

```
requirements.txt
    â”‚
    â”œâ”€â–º trimesh (3D mesh operations)
    â”‚   â””â”€â–º mapbox-earcut (triangulation)
    â”‚
    â”œâ”€â–º shapely (2D geometry)
    â”‚   â””â”€â–º numpy (numerical arrays)
    â”‚
    â””â”€â–º gradio (web interface)
        â””â”€â–º fastapi (backend server)

builder.py
    â”‚
    â”œâ”€ imports trimesh
    â”œâ”€ imports shapely
    â””â”€ imports numpy

app.py
    â”‚
    â”œâ”€ imports gradio
    â””â”€ imports builder

test_builder.py
    â”‚
    â””â”€ imports builder

quickstart.py
    â”‚
    â””â”€ imports builder
```

## Error Flow

```
User uploads malformed JSON
    â”‚
    â–¼
app.py: JSON decode fails
    â”‚
    â–¼
gr.Error("Invalid JSON file: ...")
    â”‚
    â–¼
Display friendly error in UI
    â”‚
    â””â”€â–º User fixes JSON and retries
```

```
Valid JSON but missing 'walls' key
    â”‚
    â–¼
builder.py: validate input
    â”‚
    â–¼
ValueError("JSON data must contain 'walls' key")
    â”‚
    â–¼
app.py: catch exception
    â”‚
    â–¼
gr.Error("Invalid JSON format: Missing 'walls' key...")
    â”‚
    â–¼
Display helpful error with expected format
```

```
Wall has only 1 point (should be 2)
    â”‚
    â–¼
builder.py: _create_wall_polygon()
    â”‚
    â–¼
ValueError("Wall must have exactly 2 points, got 1")
    â”‚
    â–¼
Exception with context: "Error processing wall 0 with coords [[0, 0]]: ..."
    â”‚
    â–¼
app.py: catch and display
    â”‚
    â–¼
User sees which wall has the problem
```

## Success Flow (Happy Path)

```
1. User clicks "Download Sample JSON"
   â†’ generate_sample_json() creates temp file
   â†’ File appears in UI for download

2. User uploads JSON file
   â†’ Gradio stores file temporarily
   â†’ file_input receives file path

3. User clicks "Generate 3D Model"
   â†’ process_floor_plan(file) called
   
4. Validation
   â†’ JSON parsed successfully âœ“
   â†’ "walls" key exists âœ“
   â†’ Walls list is not empty âœ“
   
5. Processing
   â†’ HouseBuilder initialized
   â†’ For each wall:
       - Create buffered polygon âœ“
       - Extrude to 3D mesh âœ“
   â†’ Floor generated âœ“
   â†’ All combined into Scene âœ“
   
6. Export
   â†’ Scene exported to temp GLB file âœ“
   â†’ File path returned to UI
   
7. Display
   â†’ GLB file loaded in Model3D viewer âœ“
   â†’ Success message shown âœ“
   â†’ User can rotate/zoom/download âœ“
```

## Performance Characteristics

```
Input Size (Walls)  â”‚  Processing Time  â”‚  Memory Usage
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1-10 walls          â”‚  < 0.5 seconds    â”‚  ~50 MB
10-50 walls         â”‚  0.5-2 seconds    â”‚  ~100 MB
50-100 walls        â”‚  2-5 seconds      â”‚  ~200 MB
100-500 walls       â”‚  5-20 seconds     â”‚  ~500 MB

Bottlenecks:
1. Polygon triangulation (O(n log n) per wall)
2. Mesh combination (O(n) total faces)
3. GLB serialization (O(n) vertices)
```

---

**Legend**:
- `â”Œâ”€â”` Boxes = Components/Steps
- `â”‚` Vertical = Sequential flow
- `â”œâ”€â–º` Branches = Method calls
- `â–¼` Arrows = Data flow
- `â—` Circles = Coordinate points
